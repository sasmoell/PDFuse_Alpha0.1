<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module funktionen</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title">funktionen</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:c%3A%5Cpycharm%20projekte%5Cpdfuse_alpha0.1%5Cfunktionen.py">c:\pycharm projekte\pdfuse_alpha0.1\funktionen.py</a></td></tr></table>
    <p><span class="code">######################################################################################<br>
###&nbsp;Author:&nbsp;Sascha&nbsp;Möller,&nbsp;2023&nbsp;######################################################<br>
###&nbsp;Contact:&nbsp;sasmoell@t-online.de&nbsp;####&nbsp;With&nbsp;great&nbsp;power&nbsp;comes&nbsp;great&nbsp;responsibility&nbsp;###<br>
###&nbsp;PDFuse&nbsp;Alpha&nbsp;0.1&nbsp;#################################################################<br>
######################################################################################</span></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="logging.html">logging</a><br>
<a href="tkinter.messagebox.html">tkinter.messagebox</a><br>
</td><td class="multicolumn"><a href="os.html">os</a><br>
<a href="requests.html">requests</a><br>
</td><td class="multicolumn"><a href="subprocess.html">subprocess</a><br>
<a href="tkinter.html">tkinter</a><br>
</td><td class="multicolumn"><a href="webbrowser.html">webbrowser</a><br>
</td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-ausgabeordner_anlegen"><strong>ausgabeordner_anlegen</strong></a>()</dt><dd><span class="code">Die&nbsp;Standard&nbsp;Ausgabe-Ordner&nbsp;werden&nbsp;mit&nbsp;dieser&nbsp;Funktion&nbsp;angelegt.&nbsp;Es&nbsp;erfolgt&nbsp;eine&nbsp;Existenzprüfung.&nbsp;Wenn&nbsp;die&nbsp;Standard-Ausgabe-Ordner&nbsp;nicht&nbsp;vorhanden&nbsp;sind,&nbsp;wird&nbsp;jeweils&nbsp;die&nbsp;Hilfsfunktion&nbsp;<a href="#-ordner_pruefen_und_erstellen">ordner_pruefen_und_erstellen</a>()&nbsp;aufgerufen.<br>
:return:</span></dd></dl>
 <dl><dt><a name="-gen_error"><strong>gen_error</strong></a>(titel, message)</dt><dd><span class="code">Generische&nbsp;Fehlermeldung&nbsp;mit&nbsp;Log-Funktion&nbsp;auf&nbsp;Debug-Level.&nbsp;Titel&nbsp;und&nbsp;Text&nbsp;werden&nbsp;als&nbsp;Parameter&nbsp;übergeben.&nbsp;Die&nbsp;Fehlermeldung&nbsp;erscheint&nbsp;als&nbsp;Tk.Messagebox.<br>
:param&nbsp;titel:<br>
:param&nbsp;message:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-gen_message_info"><strong>gen_message_info</strong></a>(titel, message)</dt><dd><span class="code">Generischer&nbsp;Hinweis.&nbsp;Titel&nbsp;und&nbsp;Text&nbsp;werden&nbsp;als&nbsp;Parameter&nbsp;übergeben.&nbsp;Die&nbsp;Meldung&nbsp;erscheint&nbsp;als&nbsp;Tk.Messagebox.<br>
:param&nbsp;titel:<br>
:param&nbsp;message:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-gen_yesno"><strong>gen_yesno</strong></a>(titel, message)</dt><dd><span class="code">Generische&nbsp;Abfrage&nbsp;JA/NEIN.&nbsp;Titel&nbsp;und&nbsp;Text&nbsp;werden&nbsp;als&nbsp;Parameter&nbsp;übergeben.&nbsp;Die&nbsp;Abfrage&nbsp;erscheint&nbsp;als&nbsp;Tk.Messagebox.<br>
:param&nbsp;titel:<br>
:param&nbsp;message:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-onlineversion_pruefen"><strong>onlineversion_pruefen</strong></a>()</dt><dd><span class="code">Die&nbsp;Variable&nbsp;vers_url&nbsp;beinhaltet&nbsp;URL&nbsp;zu&nbsp;der&nbsp;Textdatei&nbsp;release.dat.&nbsp;Die&nbsp;Datei&nbsp;beinhaltet&nbsp;ausschließlich&nbsp;eine&nbsp;Versionsnummer,&nbsp;welche&nbsp;mit&nbsp;der&nbsp;aktuell&nbsp;verwendeten&nbsp;Version&nbsp;verglichen&nbsp;wird.&nbsp;Diese&nbsp;Funktion&nbsp;fragt&nbsp;den&nbsp;Status&nbsp;der&nbsp;Datei&nbsp;ab,&nbsp;um&nbsp;die&nbsp;Erreichbarkeit&nbsp;abzufragen.&nbsp;Wenn&nbsp;der&nbsp;Status&nbsp;200&nbsp;lautet,&nbsp;wird&nbsp;der&nbsp;Inhalt&nbsp;(Versionsnummer)&nbsp;zurückgegeben.&nbsp;Lautet&nbsp;der&nbsp;Status&nbsp;!=200,&nbsp;wird&nbsp;eine&nbsp;Fehlermeldung&nbsp;ausgegeben.&nbsp;Unabhängig&nbsp;vom&nbsp;Erfolg,&nbsp;wird&nbsp;die&nbsp;Datei&nbsp;am&nbsp;Ende&nbsp;der&nbsp;Funktion&nbsp;geschlossen.<br>
:return:&nbsp;Versionsnummer&nbsp;(content)</span></dd></dl>
 <dl><dt><a name="-ordner_oeffnen"><strong>ordner_oeffnen</strong></a>(pfad)</dt><dd><span class="code">Die&nbsp;Funktion&nbsp;verwendet&nbsp;subprocess,&nbsp;um&nbsp;über&nbsp;den&nbsp;File-Explorer&nbsp;einen&nbsp;Ordner&nbsp;aufzurufen.&nbsp;Auch&nbsp;wenn&nbsp;PDFuser&nbsp;auf&nbsp;macOS&nbsp;oder&nbsp;Linux&nbsp;noch&nbsp;nicht&nbsp;lauffähig&nbsp;ist,&nbsp;sind&nbsp;hier&nbsp;bereits&nbsp;subprocess-Routinen&nbsp;für&nbsp;die&nbsp;Betriebssysteme&nbsp;integriert.<br>
:param&nbsp;pfad:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-ordner_pruefen_und_erstellen"><strong>ordner_pruefen_und_erstellen</strong></a>(pfad)</dt><dd><span class="code">Hilfs-Funktion:&nbsp;Diese&nbsp;Funktion&nbsp;wird&nbsp;nur&nbsp;innerhalb&nbsp;einer&nbsp;anderen&nbsp;Funktion&nbsp;aufgerufen.&nbsp;Z.B.&nbsp;in&nbsp;der&nbsp;Funktion&nbsp;<a href="#-ausgabeordner_anlegen">ausgabeordner_anlegen</a>()<br>
:param&nbsp;pfad:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-pdf_splitten"><strong>pdf_splitten</strong></a>(quelldatei, split_output_ordner)</dt><dd><span class="code">In&nbsp;dieser&nbsp;Funktion&nbsp;wird&nbsp;der&nbsp;PdfReader&nbsp;UND&nbsp;PdfWriter&nbsp;aus&nbsp;pypdf&nbsp;genutzt.&nbsp;Die&nbsp;Quelldatei&nbsp;wird&nbsp;im&nbsp;binären&nbsp;Lesemodus&nbsp;geöffnet&nbsp;und&nbsp;an&nbsp;den&nbsp;PdfReader&nbsp;übergeben.&nbsp;Mit&nbsp;einer&nbsp;FOR-Schleife&nbsp;und&nbsp;der&nbsp;page-Methode&nbsp;werden&nbsp;die&nbsp;einzelnen&nbsp;Seiten&nbsp;gelistet&nbsp;und&nbsp;an&nbsp;den&nbsp;PdfWriter&nbsp;übergeben.&nbsp;Da&nbsp;die&nbsp;Quelldatei&nbsp;im&nbsp;Lesemodus&nbsp;'rb'&nbsp;geöffnet&nbsp;wird,&nbsp;ist&nbsp;an&nbsp;dieser&nbsp;Stelle&nbsp;sichergestellt,&nbsp;dass&nbsp;die&nbsp;Ursprungsdatei&nbsp;nicht&nbsp;verändert&nbsp;wird.&nbsp;Erst&nbsp;die&nbsp;Liste&nbsp;der&nbsp;einzelnen&nbsp;Seiten&nbsp;wird&nbsp;im&nbsp;Schreibmodus&nbsp;verwendet.<br>
:param&nbsp;quelldatei:<br>
:param&nbsp;split_output_ordner:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-pdf_zusammenfassen"><strong>pdf_zusammenfassen</strong></a>(eingabe_ordner, ausgabe_datei)</dt><dd><span class="code">Diese&nbsp;Funktion&nbsp;nutzt&nbsp;aus&nbsp;der&nbsp;Bibliothek&nbsp;PyPDF&nbsp;die&nbsp;Funktion&nbsp;PdfWriter.&nbsp;Die&nbsp;Instanz&nbsp;wurde&nbsp;mit&nbsp;"merger"&nbsp;deklariert.&nbsp;Im&nbsp;ersten&nbsp;Schritt&nbsp;werden&nbsp;alle&nbsp;Dateien&nbsp;aus&nbsp;dem&nbsp;Eingabeordner&nbsp;in&nbsp;eine&nbsp;Liste&nbsp;gesammelt&nbsp;mit&nbsp;einer&nbsp;List-Comprehension.&nbsp;Im&nbsp;nächsten&nbsp;Schritt&nbsp;wird&nbsp;überprüft,&nbsp;ob&nbsp;der&nbsp;Standard-Ausgabeordner&nbsp;existiert.&nbsp;Falls&nbsp;nicht,&nbsp;wird&nbsp;versucht&nbsp;ihn&nbsp;zu&nbsp;erstellen.&nbsp;Die&nbsp;folgende&nbsp;erneute&nbsp;FOR-Schleife&nbsp;dient&nbsp;dazu,&nbsp;die&nbsp;Dateipfad&nbsp;zu&nbsp;erstellen,&nbsp;welche&nbsp;dem&nbsp;PdfWriter-Objekt&nbsp;(merger)&nbsp;hinzugefügt&nbsp;werden.&nbsp;Mit&nbsp;der&nbsp;write-Methode&nbsp;wird&nbsp;nun&nbsp;die&nbsp;Datei&nbsp;geschrieben,&nbsp;die&nbsp;alle&nbsp;PDF-Dokumente&nbsp;beinhaltet.&nbsp;Abschließend&nbsp;wird&nbsp;sichergestellt,&nbsp;dass&nbsp;alle&nbsp;Ressourcen&nbsp;mit&nbsp;der&nbsp;close-Methode&nbsp;wieder&nbsp;freigegeben&nbsp;werden&nbsp;und&nbsp;eine&nbsp;Bestätigungsmeldung&nbsp;erscheint.<br>
:param&nbsp;eingabe_ordner:<br>
:param&nbsp;ausgabe_datei:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-update_check"><strong>update_check</strong></a>()</dt><dd><span class="code">Die&nbsp;Hilfsfunktion&nbsp;<a href="#-onlineversion_pruefen">onlineversion_pruefen</a>()&nbsp;wird&nbsp;ausgeführt.&nbsp;Die&nbsp;ermittelte&nbsp;Online-Versionsnummer&nbsp;wird&nbsp;mit&nbsp;der&nbsp;lokalen&nbsp;Versionsnummer&nbsp;verglichen.&nbsp;Je&nbsp;nach&nbsp;Ergebnis,&nbsp;wird&nbsp;eine&nbsp;Update-Meldung&nbsp;angezeigt.<br>
:return:</span></dd></dl>
 <dl><dt><a name="-update_seite_oeffnen"><strong>update_seite_oeffnen</strong></a>()</dt><dd><span class="code">Öffnet&nbsp;die&nbsp;Onlinedokumentation&nbsp;im&nbsp;Standard-Browser<br>
:return:</span></dd></dl>
</td></tr></table><p>
<table class="section">
<tr class="decor data-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Data</strong></td></tr>
    
<tr><td class="decor data-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><strong>current_version</strong> = '0.1.2306'<br>
<strong>split_output_ordner</strong> = 'output/newFiles'<br>
<strong>update_pageurl</strong> = 'https://mark42.de/'</td></tr></table>
</body></html>